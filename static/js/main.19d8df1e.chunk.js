(this["webpackJsonpwork-hours-react"]=this["webpackJsonpwork-hours-react"]||[]).push([[0],{63:function(e,t,a){},69:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(9),l=a.n(o),s=(a(63),a(49)),r=a(22),c=a(23),u=a(12),d=a(25),h=a(24),g=a(39),m=a(40),p=(a(69),a(113)),v=a(116),y=a(112),f=a(110),b=a(111),C=a(109),E=a(114),k=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).gapi=window.gapi,n.handleLoginClick=n.handleLoginClick.bind(Object(u.a)(n)),n.handleLogoutClick=n.handleLogoutClick.bind(Object(u.a)(n)),n.initClient=n.initClient.bind(Object(u.a)(n)),n.state={apiSettingsAvilable:!1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.gapi.load("client:auth2",this.initClient)}},{key:"initClient",value:function(){var e=window.localStorage.getItem("clientId"),t=window.localStorage.getItem("apiKey");if(null==e||0===e.length||null==t||0===t.length)window.alert("Set the Google Calendar client ID and API key in the Settings dialog.");else{this.setState({apiSettingsAvilable:!0});var a=this;this.gapi.client.init({apiKey:t,clientId:e,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],scope:"https://www.googleapis.com/auth/calendar.readonly"}).then((function(){a.gapi.auth2.getAuthInstance().isSignedIn.listen(a.props.onAuthChange),a.props.onAuthChange(a.gapi.auth2.getAuthInstance().isSignedIn.get())}),(function(e){console.error(JSON.stringify(e,null,2))}))}}},{key:"handleLoginClick",value:function(){this.gapi.auth2.getAuthInstance().signIn()}},{key:"handleLogoutClick",value:function(){this.gapi.auth2.getAuthInstance().signOut()}},{key:"render",value:function(){var e=this.props.isLoggedIn;return null==e?i.a.createElement("span",{className:"float-right"},i.a.createElement(w,null)):e?i.a.createElement(O,{onClick:this.handleLogoutClick}):i.a.createElement(I,{onClick:this.handleLoginClick})}}]),a}(i.a.Component),w=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleClientIdChange=function(e){n.setState({clientId:e.target.value})},n.handleApiKeyChange=function(e){n.setState({apiKey:e.target.value})},n.handleClickOpen=function(){n.setState({open:!0}),console.log(n.open)},n.handleClose=function(){n.setState({open:!1}),console.log(n.open),window.localStorage.setItem("clientId",n.state.clientId),window.localStorage.setItem("apiKey",n.state.apiKey),window.location.reload()},n.state={open:!1,clientId:window.localStorage.getItem("clientId")||"",apiKey:window.localStorage.getItem("apiKey")||""},n}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement("span",null,i.a.createElement("button",{className:"settings-btn",onClick:this.handleClickOpen},i.a.createElement(g.a,{icon:m.c})),i.a.createElement(v.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},i.a.createElement(C.a,{id:"form-dialog-title"},"Settings"),i.a.createElement(f.a,null,i.a.createElement(b.a,null,"To access the Google Calendar API, fill in the following information:"),i.a.createElement(p.a,{autoFocus:!0,margin:"dense",id:"clientId",label:"Client ID",type:"text",value:this.state.clientId,onChange:this.handleClientIdChange,fullWidth:!0}),i.a.createElement(p.a,{margin:"dense",id:"apiKey",label:"API Key",type:"text",value:this.state.apiKey,onChange:this.handleApiKeyChange,fullWidth:!0})),i.a.createElement(y.a,null,i.a.createElement(E.a,{onClick:this.handleClose,color:"primary"},"Save"))))}}]),a}(i.a.Component),I=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement("span",{className:"float-right"},i.a.createElement(w,null),i.a.createElement("button",{className:"button",onClick:this.props.onClick},"Authorize"))}}]),a}(i.a.Component),O=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement("span",{className:"float-right"},i.a.createElement(w,null),i.a.createElement("button",{className:"button",onClick:this.props.onClick},"Log Out"))}}]),a}(i.a.Component),D=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;Object(r.a)(this,a),(n=t.call(this,e)).handleDateChange=n.handleDateChange.bind(Object(u.a)(n)),n.updateEvents=n.updateEvents.bind(Object(u.a)(n)),n.gapi=window.gapi;return n.listItems=[{name:"Event A",hours:.5},{name:"Event B",hours:1.5}].map((function(e){return i.a.createElement("li",{key:e.name},i.a.createElement("span",null,e.name," \u2014 "),i.a.createElement("span",{className:"bold"},e.hours))})),n.state={date:new Date,listItems:null,totalHours:-1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateEvents()}},{key:"componentDidUpdate",value:function(e,t){e.isLoggedIn==this.props.isLoggedIn&&t.date==this.state.date||this.updateEvents()}},{key:"updateEvents",value:function(){if(this.props.isLoggedIn){var e=new Date(this.state.date.getTime());e.setHours(0,0,0,0);var t=new Date(this.state.date.getTime());t.setHours(23,59,59,0);var a=this;this.gapi.client.calendar.calendarList.list().then((function(e){for(var t=e.result.items,a=0;a<t.length;a++)if("Work Hours"==t[a].summary)return console.log(t[a].id),t[a].id;return console.error("Could not find calendar; defaulting to primary"),"primary"})).then((function(n){return a.gapi.client.calendar.events.list({calendarId:n,timeMin:e.toISOString(),timeMax:t.toISOString(),showDeleted:!1,singleEvents:!0,maxResults:30,orderBy:"startTime"})})).then((function(e){var t,n=e.result.items,o=new Object,l=0;if(n.length>0){for(var r=0;r<n.length;r++){var c=n[r],u=c.start.dateTime;if(u){var d=c.end.dateTime,h=(Date.parse(d)-Date.parse(u))/1e3/60/60,g=c.summary;o.hasOwnProperty(g)?o[g]+=h:o[g]=h,l+=h}}t=Object.entries(o).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return i.a.createElement("li",{key:a},i.a.createElement("span",null,a," \u2014 "),i.a.createElement("span",{className:"bold"},n))}))}a.setState((function(e){return{totalHours:l,listItems:t}}))}))}else this.setState((function(e){return{totalHours:-1,listItems:null}}))}},{key:"handleDateChange",value:function(e){this.setState((function(t){return{date:e,totalHours:-1}}))}},{key:"render",value:function(){var e;return console.log(this.props.isLoggedIn),e=null===this.props.isLoggedIn||this.props.isLoggedIn&&this.state.totalHours<0?i.a.createElement("span",{className:"good-job"},"loading..."):this.props.isLoggedIn?0==this.state.totalHours?i.a.createElement("div",null,i.a.createElement("span",{className:"good-job"},"0 hours today. no worries!"),i.a.createElement(j,{date:this.state.date,onDateChange:this.handleDateChange})):i.a.createElement("div",null,i.a.createElement("span",{className:"good-job"}," way to go! today's total: ",i.a.createElement("span",{className:"total-hours"},this.state.totalHours," hours")),i.a.createElement("span",null," Here's the breakdown \u2014"),i.a.createElement("ul",null,this.state.listItems),i.a.createElement(j,{date:this.state.date,onDateChange:this.handleDateChange})):i.a.createElement("span",{className:"good-job"},"log in to see your hours!"),i.a.createElement("div",null,e)}}]),a}(i.a.Component),j=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={dateString:n.generateDateString(new Date)},n.subtractDay=n.subtractDay.bind(Object(u.a)(n)),n.addDay=n.addDay.bind(Object(u.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"componentWillMount",value:function(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"componentDidMount",value:function(){var e=this;this.setState((function(t){return{dateString:e.generateDateString(e.props.date)}}))}},{key:"componentDidUpdate",value:function(e){var t=this;e.date!=this.props.date&&this.setState((function(e){return{dateString:t.generateDateString(t.props.date)}}))}},{key:"onKeyDown",value:function(e){e.stopPropagation(),console.log(e.which),39===e.which?this.addDay():37===e.which&&this.subtractDay()}},{key:"generateDateString",value:function(e){return new Intl.DateTimeFormat("en-us",{weekday:"long",month:"long",day:"numeric",year:"numeric"}).format(e)}},{key:"addDays",value:function(e){var t=new Date(this.props.date.getTime()+864e5*e);this.props.onDateChange(t)}},{key:"subtractDay",value:function(){this.addDays(-1)}},{key:"addDay",value:function(){this.addDays(1)}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(g.a,{icon:m.a,onClick:this.subtractDay,className:"date-btn"}),i.a.createElement("span",{className:"date"},this.state.dateString),i.a.createElement(g.a,{icon:m.b,onClick:this.addDay,className:"date-btn"}))}}]),a}(i.a.Component),S=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleAuthChange=n.handleAuthChange.bind(Object(u.a)(n)),n.state={isLoggedIn:null},n}return Object(c.a)(a,[{key:"handleAuthChange",value:function(e){console.log(e),this.setState({isLoggedIn:e})}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("header",null,i.a.createElement("span",{className:"title"},"Michaela's Work Hours"),i.a.createElement(k,{isLoggedIn:this.state.isLoggedIn,onAuthChange:this.handleAuthChange}),i.a.createElement(D,{isLoggedIn:this.state.isLoggedIn})))}}]),a}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[71,1,2]]]);
//# sourceMappingURL=main.19d8df1e.chunk.js.map